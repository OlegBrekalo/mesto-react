(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,n){e.exports=n(18)},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),i=n(11),l=n(2),u=n(1),s=r.a.createContext(),m=n(8),p=n.n(m);var f=function(){return r.a.createElement("header",{className:"header content-section"},r.a.createElement("img",{src:p.a,alt:"\u041c\u0435\u0441\u0442\u043e-\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}))},_=n(12);var d=function(e){var t=this,n=e.id,a=e.name,o=e.link,c=e.likes,i=e.owner,l=e.onClick,m=e.onLike,p=e.onDelete,f=r.a.useContext(s),_=Object(u.a)(f,2),d=_[0],b=(_[1],!(0==c.length||!c.find((function(e){return e._id===d.id})))),h=d.id===i._id?"element__remove-icon  element__remove-icon_show":"element__remove-icon",v=b?"element__like-icon element__like-icon_checked":"element__like-icon";return r.a.createElement("li",{className:"element"},r.a.createElement("button",{type:"button",className:h,onClick:function(){p(n)}}),r.a.createElement("img",{src:o,alt:"#",className:"element__image",onClick:function(){l.call(t,o,a)},onError:function(e){e.target.src="https://images.unsplash.com/photo-1458419948946-19fb2cc296af?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80"}}),r.a.createElement("div",{className:"element__footer"},r.a.createElement("h2",{className:"element__title",title:a},a),r.a.createElement("div",{className:"element__like-block"},r.a.createElement("button",{type:"button",className:v,onClick:function(){m(b,n)}}),r.a.createElement("p",{className:"element__like-couter"},c?c.length:0))))};var b=function(e){var t=e.handlersProfile,n=e.cards,a=e.handlersCard,o=r.a.useContext(s),c=Object(u.a)(o,1)[0];return r.a.createElement("main",null,r.a.createElement("section",{className:"profile content-section"},r.a.createElement("div",{className:"profile__avatar-wrapper"},r.a.createElement("img",{src:c.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar",onClick:function(){return t.setOpenEditAvatar(!0)}})),r.a.createElement("div",{className:"profile__profile-info"},r.a.createElement("h2",{className:"profile__name"},c.name),r.a.createElement("button",{type:"button",className:"profile__edit-button",onClick:function(){return t.setOpenEditProfile(!0)}}),r.a.createElement("p",{className:"profile__job"},c.about)),r.a.createElement("button",{type:"button",className:"profile__add-button",onClick:function(){return t.setOpenAddPlace(!0)}})),r.a.createElement("section",{className:"elements content-section"},r.a.createElement("ul",{className:"elements__img-grid"},n.map((function(e){var t=e._id,n=Object(_.a)(e,["_id"]);return r.a.createElement(d,Object.assign({key:t,id:t},n,{onClick:a.click,onLike:a.like,onDelete:a.delete}))})))))};var h=function(){return r.a.createElement("footer",{className:"footer content-section"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var v=function(e){var t=e.onSubmit,n=r.a.useContext(s),o=Object(u.a)(n,1)[0],c=r.a.useState(""),i=Object(u.a)(c,2),l=i[0],m=i[1],p=r.a.useState(""),f=Object(u.a)(p,2),_=f[0],d=f[1],b=Object(a.useRef)(null);return Object(a.useEffect)((function(){m(o.name),d(o.about)}),[o]),r.a.createElement("form",{className:"popup__form",autoComplete:"off",onSubmit:function(e){e.preventDefault(),t(l,_,b)}},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"edit-form_name",name:"edit-form_name",type:"text",required:!0,minLength:2,maxLength:40,className:"popup__input-text edit-popup__input-text_type_name",value:l,onChange:function(e){return m(e.target.value)}}),r.a.createElement("span",{id:"edit-form_name-error",className:"popup__input-error"})),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"edit-form_about",name:"edit-form_about",type:"text",required:!0,minLength:2,maxLength:200,className:"popup__input-text edit-popup__input-text_type_job",value:_,onChange:function(e){return d(e.target.value)}}),r.a.createElement("span",{id:"edit-form_about-error",className:"popup__input-error"})),r.a.createElement("button",{type:"submit",className:"popup__submit-button",ref:b},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))};var E=function(e){var t=e.isOpen,n=e.title,a=e.name,o=e.childForm,c=e.onClose,i="popup popup-".concat(a);return t&&(i+=" popup_opened"),r.a.createElement("div",{className:i,onClick:function(e){e.currentTarget===e.target&&c()}},r.a.createElement("div",{className:"popup__container popup__container_type_form"},r.a.createElement("button",{type:"button",className:"popup__close-icon",onClick:c}),r.a.createElement("p",{className:"popup__title"},n),o))};var g=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit;return r.a.createElement(E,{isOpen:t,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",childForm:r.a.createElement(v,{onSubmit:a}),onClose:n})};var O=function(e){var t=e.onSubmit,n=Object(a.useRef)(null),o=Object(a.useRef)(null);return r.a.createElement("form",{className:"popup__form",autoComplete:"off",onSubmit:function(e){e.preventDefault();t(n.current.value,o,(function(){n.current.value=""}))}},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"avatar-form_src",name:"avatar-form_src",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__input-text avatar-form__input-text_type_src",ref:n}),r.a.createElement("span",{id:"avatar-form_src-error",className:"popup__input-error"})),r.a.createElement("button",{type:"submit",className:"popup__submit-button",ref:o},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit;return r.a.createElement(E,{isOpen:t,title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",childForm:r.a.createElement(O,{onSubmit:a}),onClose:n})};var k=function(e){var t=e.onSubmit,n=r.a.useState(""),o=Object(u.a)(n,2),c=o[0],i=o[1],l=r.a.useState(""),s=Object(u.a)(l,2),m=s[0],p=s[1],f=Object(a.useRef)(null);return r.a.createElement("form",{className:"popup__form",autoComplete:"off",onSubmit:function(e){e.preventDefault();t(c,m,f,(function(){i(""),p("")}))}},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"add-form_name",name:"add-form_name",type:"text",required:!0,minLength:1,maxLength:30,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input-text add-form__input-text_type_name",value:c,onChange:function(e){return i(e.target.value)}}),r.a.createElement("span",{id:"add-form_name-error",className:"popup__input-error"})),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"add-form_src",name:"add-form_src",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input-text add-form__input-text_type_src",value:m,onChange:function(e){return p(e.target.value)}}),r.a.createElement("span",{id:"add-form_src-error",className:"popup__input-error"})),r.a.createElement("button",{type:"submit",className:"popup__submit-button",ref:f},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))};var N=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit;return r.a.createElement(E,{isOpen:t,title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",childForm:r.a.createElement(k,{onSubmit:a}),onClose:n})};var j=function(e){var t=e.onSubmit,n=Object(a.useRef)(null);return r.a.createElement("form",{className:"popup__form",autoComplete:"off",onSubmit:function(e){e.preventDefault(),t(n)}},r.a.createElement("button",{type:"submit",className:"popup__submit-button",ref:n},"\u0414\u0430"))};var y=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit;return r.a.createElement(E,{isOpen:t,title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-card",childForm:r.a.createElement(j,{onSubmit:a}),onClose:n})};var S=function(e){var t=e.isOpen,n=e.src,a=e.subtitle,o=e.onClose,c="popup";return t&&(c+=" popup_opened"),r.a.createElement("div",{className:c,onClick:function(e){e.currentTarget===e.target&&o()}},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{type:"button",className:"popup__close-icon",onClick:o}),r.a.createElement("img",{src:n,alt:"#",className:"popup__image"}),r.a.createElement("p",{className:"popup__img-subtitle"},a)))},x=(n(6),n(9)),D=n(10),L=new(function(){function e(t,n){Object(x.a)(this,e),this._url=t,this._token=n}return Object(D.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._url+"users/me",{method:"GET",headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"updateUserInfo",value:function(e,t){var n=this;return fetch(this._url+"users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._getResponseData(e)}))}},{key:"updateUserAvatar",value:function(e){var t=this;return fetch(this._url+"users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseData(e)}))}},{key:"getCards",value:function(){var e=this;return fetch(this._url+"cards",{method:"GET",headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._url+"cards",{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._getResponseData(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._url+"cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}},{key:"putLike",value:function(e){var t=this;return fetch(this._url+"cards/likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch(this._url+"cards/likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}}]),e}())("https://mesto.nomoreparties.co/v1/cohort-15/","00e3d586-abb9-483a-af25-8c5b37844ed8");var P=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),m=Object(u.a)(c,2),p=m[0],_=m[1],d=Object(a.useState)(!1),v=Object(u.a)(d,2),E=v[0],O=v[1],k=Object(a.useState)(null),j=Object(u.a)(k,2),x=j[0],D=j[1],P=Object(a.useState)(null),R=Object(u.a)(P,2),T=R[0],w=R[1],U=r.a.useState({id:"",name:"",about:"",avatar:""}),A=Object(u.a)(U,2),z=A[0],q=A[1];Object(a.useEffect)((function(){Promise.all([L.getUserInfo(),L.getCards()]).then((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];B(a),q({id:n._id,name:n.name,about:n.about,avatar:n.avatar})})).catch((function(e){console.log("Error on - First Init"),console.log("Error message - ".concat(e))}))}),[]);var F=function(e){"Escape"===e.key&&I()};Object(a.useEffect)((function(){document.addEventListener("keydown",F)}),[n,p,E,T]);var I=function(){o(!1),_(!1),O(!1),D(null),w(null),document.removeEventListener("keydown",F)},J=Object(a.useState)([]),H=Object(u.a)(J,2),M=H[0],B=H[1],G=function(e,t){B(M.map((function(n){return n._id===e?Object(l.a)(Object(l.a)({},n),{},{likes:t.likes}):n})))};return r.a.createElement("div",{className:"content"},r.a.createElement(s.Provider,{value:[z,q]},r.a.createElement(f,null),r.a.createElement(b,{cards:M,handlersProfile:{setOpenEditProfile:o,setOpenEditAvatar:O,setOpenAddPlace:_},handlersCard:{click:function(e,t){w({src:e,subtitle:t})},like:function(e,t){e?L.removeLike(t).then((function(e){G(t,e)})).catch((function(e){console.log("Error on - removeLike"),console.log("Error message - ".concat(e))})):L.putLike(t).then((function(e){G(t,e)})).catch((function(e){console.log("Error on - putLike"),console.log("Error message - ".concat(e))}))},delete:function(e){D(e)}}}),r.a.createElement(h,null),r.a.createElement(g,{isOpen:n,onClose:I,onSubmit:function(e,t,n){var a=n.current.textContent;n.current.textContent="\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",L.updateUserInfo(e,t).then((function(e){q(Object(l.a)(Object(l.a)({},z),{},{name:e.name,about:e.about})),n.current.textContent=a,I()})).catch((function(e){console.log("Error on - handleUpdateUserProfile"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(C,{isOpen:E,onClose:I,onSubmit:function(e,t,n){var a=t.current.textContent;t.current.textContent="\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",L.updateUserAvatar(e).then((function(e){q(Object(l.a)(Object(l.a)({},z),{},{avatar:e.avatar})),t.current.textContent=a,n(),I()})).catch((function(e){console.log("Error on - handleUpdateUserAvatar"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(N,{isOpen:p,onClose:I,onSubmit:function(e,t,n,a){var r=n.current.textContent;n.current.textContent="\u0421\u043e\u0437\u0434\u0430\u044e...",L.addNewCard(e,t).then((function(e){B([e].concat(Object(i.a)(M))),n.current.textContent=r,a(),I()})).catch((function(e){console.log("Error on - handleAddPlaceSubmit"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(y,{isOpen:!!x,onClose:I,onSubmit:function(e){var t=e.current.textContent;e.current.textContent="\u0423\u0434\u0430\u043b\u044f\u044e...",L.deleteCard(x).then((function(){B(M.filter((function(e){return e._id!==x}))),e.current.textContent=t,I()})).catch((function(e){console.log("Error on - handleRemovePlaceSubmit"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(S,Object.assign({isOpen:!!T},T,{onClose:I}))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root"))},6:function(e,t,n){},8:function(e,t,n){e.exports=n.p+"static/media/mesto-logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.d1f15ddc.chunk.js.map