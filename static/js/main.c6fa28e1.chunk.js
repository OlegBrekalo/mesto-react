(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,n){e.exports=n(18)},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),i=n(11),l=n(2),s=n(1),u=r.a.createContext(),m=n(8),p=n.n(m);var _=function(){return r.a.createElement("header",{className:"header content-section"},r.a.createElement("img",{src:p.a,alt:"\u041c\u0435\u0441\u0442\u043e-\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}))},f=n(12);var d=function(e){var t=this,n=e.id,a=e.name,o=e.link,c=e.likes,i=e.owner,l=e.onClick,s=e.onLike,m=e.onDelete,p=r.a.useContext(u),_=!(0===c.length||!c.find((function(e){return e._id===p.id}))),f=p.id===i._id?"element__remove-icon  element__remove-icon_show":"element__remove-icon",d=_?"element__like-icon element__like-icon_checked":"element__like-icon";return r.a.createElement("li",{className:"element"},r.a.createElement("button",{type:"button",className:f,onClick:function(){m(n)}}),r.a.createElement("img",{src:o,alt:"#",className:"element__image",onClick:function(){l.call(t,o,a)},onError:function(e){e.target.src="https://images.unsplash.com/photo-1458419948946-19fb2cc296af?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80"}}),r.a.createElement("div",{className:"element__footer"},r.a.createElement("h2",{className:"element__title",title:a},a),r.a.createElement("div",{className:"element__like-block"},r.a.createElement("button",{type:"button",className:d,onClick:function(){s(_,n)}}),r.a.createElement("p",{className:"element__like-couter"},c?c.length:0))))};var h=function(e){var t=e.handlersProfile,n=e.cards,a=e.handlersCard,o=r.a.useContext(u);return r.a.createElement("main",null,r.a.createElement("section",{className:"profile content-section"},r.a.createElement("div",{className:"profile__avatar-wrapper"},r.a.createElement("img",{src:o.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar",onClick:function(){return t.setOpenEditAvatar(!0)}})),r.a.createElement("div",{className:"profile__profile-info"},r.a.createElement("h2",{className:"profile__name"},o.name),r.a.createElement("button",{type:"button",className:"profile__edit-button",onClick:function(){return t.setOpenEditProfile(!0)}}),r.a.createElement("p",{className:"profile__job"},o.about)),r.a.createElement("button",{type:"button",className:"profile__add-button",onClick:function(){return t.setOpenAddPlace(!0)}})),r.a.createElement("section",{className:"elements content-section"},r.a.createElement("ul",{className:"elements__img-grid"},n.map((function(e){var t=e._id,n=Object(f.a)(e,["_id"]);return r.a.createElement(d,Object.assign({key:t,id:t},n,{onClick:a.click,onLike:a.like,onDelete:a.delete}))})))))};var b=function(){return r.a.createElement("footer",{className:"footer content-section"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var E=function(e){var t=e.isOpen,n=e.title,o=e.name,c=e.inputs,i=e.buttonText,l=e.onClose,s=e.onSubmit,u=Object(a.useRef)(null),m="popup popup-".concat(o);return t&&(m+=" popup_opened"),r.a.createElement("div",{className:m,onClick:function(e){e.currentTarget===e.target&&l()}},r.a.createElement("div",{className:"popup__container popup__container_type_form"},r.a.createElement("button",{type:"button",className:"popup__close-icon",onClick:l}),r.a.createElement("p",{className:"popup__title"},n),r.a.createElement("form",{className:"popup__form",autoComplete:"off",onSubmit:function(e){e.preventDefault(),s(u)}},c,r.a.createElement("button",{type:"submit",className:"popup__submit-button",ref:u},i))))};var v=function(e){var t=e.isOpen,n=e.onClose,o=e.onSubmit,c=r.a.useContext(u),i=r.a.useState(""),l=Object(s.a)(i,2),m=l[0],p=l[1],_=r.a.useState(""),f=Object(s.a)(_,2),d=f[0],h=f[1];return Object(a.useEffect)((function(){p(c.name),h(c.about)}),[c]),r.a.createElement(E,{isOpen:t,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onClose:n,onSubmit:function(e){o(m,d,e)},inputs:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"edit-form_name",name:"edit-form_name",type:"text",required:!0,minLength:2,maxLength:40,className:"popup__input-text edit-popup__input-text_type_name",value:m,onChange:function(e){return p(e.target.value)}}),r.a.createElement("span",{id:"edit-form_name-error",className:"popup__input-error"})),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"edit-form_about",name:"edit-form_about",type:"text",required:!0,minLength:2,maxLength:200,className:"popup__input-text edit-popup__input-text_type_job",value:d,onChange:function(e){return h(e.target.value)}}),r.a.createElement("span",{id:"edit-form_about-error",className:"popup__input-error"})))})};var g=function(e){var t=e.isOpen,n=e.onClose,o=e.onSubmit,c=Object(a.useRef)(null);return r.a.createElement(E,{isOpen:t,title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onClose:n,onSubmit:function(e){o(c.current.value,e,(function(){c.current.value=""}))},inputs:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"avatar-form_src",name:"avatar-form_src",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__input-text avatar-form__input-text_type_src",ref:c}),r.a.createElement("span",{id:"avatar-form_src-error",className:"popup__input-error"})))})};var k=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit,o=r.a.useState(""),c=Object(s.a)(o,2),i=c[0],l=c[1],u=r.a.useState(""),m=Object(s.a)(u,2),p=m[0],_=m[1];return r.a.createElement(E,{isOpen:t,title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onClose:n,onSubmit:function(e){a(i,p,e,(function(){l(""),_("")}))},inputs:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"add-form_name",name:"add-form_name",type:"text",required:!0,minLength:1,maxLength:30,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input-text add-form__input-text_type_name",value:i,onChange:function(e){return l(e.target.value)}}),r.a.createElement("span",{id:"add-form_name-error",className:"popup__input-error"})),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{id:"add-form_src",name:"add-form_src",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input-text add-form__input-text_type_src",value:p,onChange:function(e){return _(e.target.value)}}),r.a.createElement("span",{id:"add-form_src-error",className:"popup__input-error"})))})};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.onSubmit;return r.a.createElement(E,{isOpen:t,title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-card",buttonText:"\u0414\u0430",onClose:n,onSubmit:function(e){a(e)}})};var O=function(e){var t=e.isOpen,n=e.src,a=e.subtitle,o=e.onClose,c="popup";return t&&(c+=" popup_opened"),r.a.createElement("div",{className:c,onClick:function(e){e.currentTarget===e.target&&o()}},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{type:"button",className:"popup__close-icon",onClick:o}),r.a.createElement("img",{src:n,alt:"#",className:"popup__image"}),r.a.createElement("p",{className:"popup__img-subtitle"},a)))},N=(n(6),n(9)),y=n(10),j=new(function(){function e(t,n){Object(N.a)(this,e),this._url=t,this._token=n}return Object(y.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._url+"users/me",{method:"GET",headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"updateUserInfo",value:function(e,t){var n=this;return fetch(this._url+"users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._getResponseData(e)}))}},{key:"updateUserAvatar",value:function(e){var t=this;return fetch(this._url+"users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseData(e)}))}},{key:"getCards",value:function(){var e=this;return fetch(this._url+"cards",{method:"GET",headers:{authorization:this._token}}).then((function(t){return e._getResponseData(t)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._url+"cards",{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._getResponseData(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._url+"cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}},{key:"putLike",value:function(e){var t=this;return fetch(this._url+"cards/likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch(this._url+"cards/likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._getResponseData(e)}))}}]),e}())("https://mesto.nomoreparties.co/v1/cohort-15/","00e3d586-abb9-483a-af25-8c5b37844ed8");var x=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),m=Object(s.a)(c,2),p=m[0],f=m[1],d=Object(a.useState)(!1),E=Object(s.a)(d,2),N=E[0],y=E[1],x=Object(a.useState)(null),S=Object(s.a)(x,2),L=S[0],T=S[1],P=Object(a.useState)(null),D=Object(s.a)(P,2),R=D[0],w=D[1],U=r.a.useState({id:"",name:"",about:"",avatar:""}),A=Object(s.a)(U,2),z=A[0],q=A[1];Object(a.useEffect)((function(){Promise.all([j.getUserInfo(),j.getCards()]).then((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];B(a),q({id:n._id,name:n.name,about:n.about,avatar:n.avatar})})).catch((function(e){console.log("Error on - First Init"),console.log("Error message - ".concat(e))}))}),[]);var I=function(e){"Escape"===e.key&&J()};Object(a.useEffect)((function(){document.addEventListener("keydown",I)}),[n,p,N,R]);var J=function(){o(!1),f(!1),y(!1),T(null),w(null),document.removeEventListener("keydown",I)},F=Object(a.useState)([]),H=Object(s.a)(F,2),M=H[0],B=H[1],G=function(e,t){B(M.map((function(n){return n._id===e?Object(l.a)(Object(l.a)({},n),{},{likes:t.likes}):n})))};return r.a.createElement("div",{className:"content"},r.a.createElement(u.Provider,{value:z},r.a.createElement(_,null),r.a.createElement(h,{cards:M,handlersProfile:{setOpenEditProfile:o,setOpenEditAvatar:y,setOpenAddPlace:f},handlersCard:{click:function(e,t){w({src:e,subtitle:t})},like:function(e,t){e?j.removeLike(t).then((function(e){G(t,e)})).catch((function(e){console.log("Error on - removeLike"),console.log("Error message - ".concat(e))})):j.putLike(t).then((function(e){G(t,e)})).catch((function(e){console.log("Error on - putLike"),console.log("Error message - ".concat(e))}))},delete:function(e){T(e)}}}),r.a.createElement(b,null),r.a.createElement(v,{isOpen:n,onClose:J,onSubmit:function(e,t,n){var a=n.current.textContent;n.current.textContent="\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",j.updateUserInfo(e,t).then((function(e){q(Object(l.a)(Object(l.a)({},z),{},{name:e.name,about:e.about})),n.current.textContent=a,J()})).catch((function(e){console.log("Error on - handleUpdateUserProfile"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(g,{isOpen:N,onClose:J,onSubmit:function(e,t,n){var a=t.current.textContent;t.current.textContent="\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",j.updateUserAvatar(e).then((function(e){q(Object(l.a)(Object(l.a)({},z),{},{avatar:e.avatar})),t.current.textContent=a,n(),J()})).catch((function(e){console.log("Error on - handleUpdateUserAvatar"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(k,{isOpen:p,onClose:J,onSubmit:function(e,t,n,a){var r=n.current.textContent;n.current.textContent="\u0421\u043e\u0437\u0434\u0430\u044e...",j.addNewCard(e,t).then((function(e){B([e].concat(Object(i.a)(M))),n.current.textContent=r,a(),J()})).catch((function(e){console.log("Error on - handleAddPlaceSubmit"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(C,{isOpen:!!L,onClose:J,onSubmit:function(e){var t=e.current.textContent;e.current.textContent="\u0423\u0434\u0430\u043b\u044f\u044e...",j.deleteCard(L).then((function(){B(M.filter((function(e){return e._id!==L}))),e.current.textContent=t,J()})).catch((function(e){console.log("Error on - handleRemovePlaceSubmit"),console.log("Error message - ".concat(e))}))}}),r.a.createElement(O,Object.assign({isOpen:!!R},R,{onClose:J}))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root"))},6:function(e,t,n){},8:function(e,t,n){e.exports=n.p+"static/media/mesto-logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.c6fa28e1.chunk.js.map